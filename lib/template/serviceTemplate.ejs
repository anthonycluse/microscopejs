/**
* <%= model.name %>Service class
*/
var <%= model.name %>Service = module.exports = (function () {

	var DbContext = require('../models/dbContext');

    /**
    * Constructor.
    */
    function <%= model.name %>Service() {
		this.dbContext = new DbContext();
    }

	// get <%= model.name %> by id
    <%= model.name %>Service.prototype.get = function(<%= model.name %>Id, next) {
        this.dbContext.<%= model.name %>.find(<%= model.name %>Id).success(function(<%= model.name %>) {
            next(<%= model.name %>);
        });
    };

    // get all <%= model.name %>
    <%= model.name %>Service.prototype.getAll = function(next) {
        this.dbContext.<%= model.name %>.findAll({order: 'id DESC'}).success(function(<%= model.name %>s) {
            next(<%= model.name %>s);
        });
    };

    // save <%= model.name %>
    <%= model.name %>Service.prototype.save = function(<%= model.name %>, next) {
        var <%= model.name %> = this.dbContext.<%= model.name %>.build(<%= model.name %>);
        var errors = <%= model.name %>.validate();
        if(errors){
            next({message: error});
        }
        <%= model.name %>.save().success(function(<%= model.name %>) {
            next(<%= model.name %>);
        }).error(function(error) {
            next({message: error});
        });
    };

    // edit a <%= model.name %>
    <%= model.name %>Service.prototype.update = function(<%= model.name %>, attributes, next){
        <%= model.name %>.updateAttributes(attributes).success(function (updated<%= model.name %>) { 
            next(updated<%= model.name %>);
        }); 
    };

    // delete an <%= model.name %>
    <%= model.name %>Service.prototype.remove = function(<%= model.name %>Id, next) {   
        this.dbContext.<%= model.name %>.find(<%= model.name %>Id).success(function(<%= model.name %>) {
			<%= model.name %>.destroy().complete(function(error) {
				next(error);
			});
        })
    };

    return <%= model.name %>Service;
})();
