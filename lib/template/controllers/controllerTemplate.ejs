/**
* Module dependencies.
*/
var _<%= model.name %>Service = require('../services/<%= model.name %>Service');

/**
* <%= model.name %>Controller class
*/
var <%= model.name %>Controller = module.exports = (function () {

    /**
    * Attributes.
    */
    var <%= model.name %>Service = new _<%= model.name %>Service();

    /**
    * Constructor.
    * @param {app} - express app.
    */
    function <%= model.name %>Controller(app) {
        this.routes(app);
    }

    /**
    * <%= model.name %>Controller routes.
    * @param {app} - express app.
    */
    <%= model.name %>Controller.prototype.routes = function(app) {
        app.get('/<%= model.name %>', this.index);
        app.get('/<%= model.name %>/details/:id', this.details);
        app.get('/<%= model.name %>/create', this.create);
        app.post('/<%= model.name %>/create', this.create_post);
        app.get('/<%= model.name %>/edit/:id', this.edit);
        app.post('/<%= model.name %>/edit', this.edit_post);
        app.get('/<%= model.name %>/delete/:id', this.delete);
        app.post('/<%= model.name %>/delete', this.delete_post);
    };

    /**
    * [httpget]
    * <%= model.name %>Controller index action.
    * @param {req} http request.
    * @param {res} http response.
    */
    <%= model.name %>Controller.prototype.index = function(req, res) {
        <%= model.name %>Service.getAll(function (<%= model.name %>s) {
            res.render('<%= model.name %>/index', { '<%= model.name %>s': <%= model.name %>s });
        });
    };

    /**
    * [httpget]
    * <%= model.name %>Controller details action.
    * @param {req} http request.
    * @param {res} http response.
    */
    <%= model.name %>Controller.prototype.details = function(req, res) {
        var <%= model.name %>Id = req.params.id;
        <%= model.name %>Service.get(<%= model.name %>Id, function (<%= model.name %>) {
            res.render('<%= model.name %>/details', { '<%= model.name %>': <%= model.name %> });
        });
    };

    /**
    * [httpget]
    * <%= model.name %>Controller edit action.
    * @param {req} http request.
    * @param {res} http response.
    */
    <%= model.name %>Controller.prototype.edit = function(req, res) {
        var <%= model.name %>Id = req.params.id;
        <%= model.name %>Service.get(<%= model.name %>Id, function (<%= model.name %>) {
            res.render('<%= model.name %>/edit', { '<%= model.name %>': <%= model.name %> });
        });
    };

    /**
    * [httppost]
    * <%= model.name %>Controller edit post action.
    * @param {req} http request.
    * @param {res} http response.
    */
    <%= model.name %>Controller.prototype.edit_post = function(req, res) {
        var attributes = req.body;
        <%= model.name %>Service.get(attributes.id, function(entity){
            if(entity){
                <%= model.name %>Service.update(entity, attributes, function (<%= model.name %>) {
                    res.redirect('/<%= model.name %>');
                });
            }
            else{
                res.send(404);
            }
        });
    };    

    /**
    * [httpget]
    * <%= model.name %>Controller create action.
    * @param {req} http request.
    * @param {res} http response.
    */
    <%= model.name %>Controller.prototype.create = function(req, res) {
        var <%= model.name %> = {};
        res.render('<%= model.name %>/create', { '<%= model.name %>': <%= model.name %> });  
    };

    /**
    * [httppost]
    * <%= model.name %>Controller create post action.
    * @param {req} http request.
    * @param {res} http response.
    */
    <%= model.name %>Controller.prototype.create_post = function(req, res) {
        <%= model.name %>Service.save(req.body, function (data) {
            res.redirect('/<%= model.name %>');
        });
    };

    /**
    * [httpget]
    * <%= model.name %>Controller delete action.
    * @param {req} http request.
    * @param {res} http response.
    */
    <%= model.name %>Controller.prototype.delete = function(req, res) {
        var <%= model.name %>Id = req.params.id;
        <%= model.name %>Service.get(<%= model.name %>Id, function (<%= model.name %>) {
            res.render('<%= model.name %>/delete', { '<%= model.name %>': <%= model.name %> });
        });
    };

    /**
    * [httppost]
    * <%= model.name %>Controller delete post action.
    * @param {req} http request.
    * @param {res} http response.
    */
    <%= model.name %>Controller.prototype.delete_post = function(req, res) {
        <%= model.name %>Service.remove(req.body.id, function (data) {
            res.redirect('/<%= model.name %>');
        });
    };

    return <%= model.name %>Controller;
})();

